<!DOCTYPE html>
<html lang="bn" class="dark">
<head>
  <meta name="description" content="অনলাইনে ফ্রি বাংলা বই পড়ুন এবং ডাউনলোড করুন।">
<script>
  (function() {
    var ua = navigator.userAgent || navigator.vendor || window.opera;
    var isFacebook = (ua.indexOf("FBAN") > -1) || (ua.indexOf("FBAV") > -1) || (ua.indexOf("Messenger") > -1);

    if (isFacebook) {
      var currentUrl = window.location.href;

      if (ua.indexOf("Android") > -1) {
        var chromeIntent = "intent://" + currentUrl.replace(/^https?:\/\//, "") + "#Intent;scheme=https;package=com.android.chrome;end";
        window.location.href = chromeIntent;
      } 
      else {
        window.addEventListener("load", function() {
          var notice = document.createElement("div");
          notice.style = "position:fixed; top:0; left:0; width:100%; background:#2f3542; color:#ffffff; padding:12px; text-align:center; z-index:99999; font-family:sans-serif; font-size:14px; border-bottom:2px solid #3742fa;";
          notice.innerHTML = "Use <strong>Chrome/Safari</strong> for a better experience and easy downloads.";
          document.body.appendChild(notice);
          document.body.style.marginTop = "50px";
        });
      }
    }
  })();
</script>
 <meta name="robots" content="index, follow, max-image-preview:large, max-snippet=-1, max-video-preview=-1" />
 <meta name="google-site-verification" content="dKuoqjOGQ3HaaASgN2DydGhgAurPvvTacR21KzA2_Ko" />
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>BoiCloud | বইক্লাউড - অনলাইন লাইব্রেরি</title>

  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M17.5 19C20.5376 19 23 16.5376 23 13.5C23 10.4624 20.5376 8 17.5 8C17.2282 8 16.9632 8.01977 16.7042 8.05791C15.6841 5.64243 13.284 4 10.5 4C6.91015 4 4 6.91015 4 10.5C4 10.742 4.0133 10.9809 4.03914 11.2158C2.26425 12.0232 1 13.8152 1 15.9C1 18.7167 3.28335 21 6.1 21H17.5V19Z' fill='%2310b981'/%3E%3Cpath d='M8 13.5C8 12.9477 8.44772 12.5 9 12.5H12V16.5H9C8.44772 16.5 8 16.0523 8 15.5V13.5Z' fill='%23059669'/%3E%3Cpath d='M16 13.5C16 12.9477 15.5523 12.5 15 12.5H12V16.5H15C15.5523 16.5 16 16.0523 16 15.5V13.5Z' fill='%232dd4bf'/%3E%3C/svg%3E">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script src="https://unpkg.com/lucide@latest"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          screens: { xs: '480px' },
          fontFamily: { bengali: ['"Hind Siliguri"', 'sans-serif'] },
          colors: {
            brand: { 50:'#f0fdf4', 100:'#dcfce7', 500:'#10b981', 600:'#059669', 700:'#047857' }
          },
          animation: {
            'slow-zoom':'slow-zoom 20s infinite alternate',
            'fade-in-up':'fade-in-up 0.8s ease-out forwards',
            'blink-soft':'blink-soft 1.2s ease-in-out infinite',
            'pop-in':'pop-in .18s ease-out forwards',
          },
          keyframes: {
            'slow-zoom': { '0%':{transform:'scale(1) translate(0,0)'}, '100%':{transform:'scale(1.1) translate(-2%,-1%)'} },
            'fade-in-up': { '0%':{opacity:'0',transform:'translateY(20px)'}, '100%':{opacity:'1',transform:'translateY(0)'} },
            'blink-soft': { '0%,100%':{filter:'brightness(1)',transform:'translateY(0px)'}, '50%':{filter:'brightness(1.12)',transform:'translateY(-1px)'} },
            'pop-in': { '0%':{opacity:'0',transform:'translateY(8px) scale(.98)'}, '100%':{opacity:'1',transform:'translateY(0) scale(1)'} },
          }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Hind Siliguri', sans-serif; -webkit-tap-highlight-color: transparent; }
    .glass-effect { backdrop-filter: blur(12px); background: rgba(255, 255, 255, 0.8); }
    .dark .glass-effect { background: rgba(15, 23, 42, 0.8); }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    .hero-gradient { background: linear-gradient(to bottom, rgba(15, 23, 42, 0.7), rgba(15, 23, 42, 0.4), rgba(15, 23, 42, 0.8)); }
    * { transition: background-color .3s ease, border-color .3s ease; }

    .category-btn:hover { box-shadow: 0 12px 30px -16px rgba(16,185,129,.45); }
    .category-btn:hover:not(.active) {
      animation: blink-soft 1.2s ease-in-out infinite;
      border-color: rgba(16,185,129,.45) !important;
    }

    .suggestions { position:absolute; top: calc(100% + 10px); left:0; right:0; z-index:60; border-radius:16px; overflow:hidden; transform-origin:top; }
    mark { padding:0 2px; border-radius:4px; background: rgba(16,185,129,.18); color: inherit; }
    .dark mark { background: rgba(16,185,129,.22); }

    .toast { position:fixed; left:50%; transform:translateX(-50%); bottom: calc(22px + env(safe-area-inset-bottom)); z-index:999; max-width:92vw; }

    .slider{
      scroll-snap-type: x proximity;
      scroll-padding-left: 20px;
      scroll-padding-right: 20px;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior-x: contain;
      scroll-behavior: smooth;
      padding-inline: 8px;
    }
    .slide-item{ scroll-snap-align: start; }
    .slide-card{
      transform: none !important;
      opacity: 1 !important;
      transition:
        box-shadow .45s cubic-bezier(0.22, 1, 0.36, 1),
        border-color .45s ease,
        transform .45s cubic-bezier(0.22, 1, 0.36, 1);
      will-change: transform;
    }
    .slide-w { width: 132px; }
    @media (min-width: 480px){ .slide-w { width: 150px; } }
    @media (min-width: 768px){ .slide-w { width: 170px; } }
    @media (min-width: 1024px){ .slide-w { width: 185px; } }

    @media (hover:hover){
      .slide-card:hover{ transform: translateY(-2px); }
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100 transition-colors duration-300 antialiased overflow-x-hidden">
  <div id="root"></div>

  <script src="books-data.js"></script>

  <script>
    lucide.createIcons();

    const escapeHtml = (s) => String(s ?? '')
      .replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')
      .replaceAll('"','&quot;').replaceAll("'",'&#039;');

    function showToast(message, type='info') {
      const old = document.getElementById('toast');
      if (old) old.remove();

      const toast = document.createElement('div');
      toast.id = 'toast';
      toast.className = 'toast animate-pop-in';
      toast.innerHTML = `
        <div class="px-4 py-3 rounded-2xl shadow-xl border backdrop-blur-md
          ${type==='error'
            ? 'bg-red-500/10 border-red-500/30 text-slate-900 dark:text-red-100'
            : 'bg-brand-500/10 border-brand-500/30 text-slate-900 dark:text-slate-100'}">
          <div class="flex items-start gap-3">
            <div class="mt-0.5">
              ${type==='error'
                ? '<i data-lucide="alert-triangle" class="w-5 h-5 text-red-400"></i>'
                : '<i data-lucide="sparkles" class="w-5 h-5 text-brand-500"></i>'}
            </div>
            <div class="text-sm leading-relaxed">${escapeHtml(message)}</div>
            <button class="ml-2 opacity-70 hover:opacity-100" aria-label="Close">
              <i data-lucide="x" class="w-4 h-4"></i>
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(toast);
      lucide.createIcons();
      toast.querySelector('button')?.addEventListener('click', () => toast.remove());
      setTimeout(() => toast.remove(), 2600);
    }

    function debounce(fn, delay=160) {
      let t;
      return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), delay); };
    }

    function highlight(text, q) {
      if (!q) return escapeHtml(text);
      const safe = escapeHtml(text);
      const query = q.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      try { return safe.replace(new RegExp(`(${query})`, 'gi'), '<mark>$1</mark>'); }
      catch { return safe; }
    }

    // ========================= ✅ AUDIO DETECT (FIXED) =========================
    function getAudioParts(book) {
      // returns array of {id,title}
      const parts = [];

      // ytParts: [{id,title}]
      if (Array.isArray(book?.ytParts) && book.ytParts.length) {
        book.ytParts.forEach((p, idx) => {
          const id = String(p?.id || '').trim();
          if (id) parts.push({ id, title: String(p?.title || `Part ${idx+1}`) });
        });
      }

      // ytIds: ["id1","id2"]
      if (!parts.length && Array.isArray(book?.ytIds) && book.ytIds.length) {
        book.ytIds.forEach((id, idx) => {
          const vid = String(id || '').trim();
          if (vid) parts.push({ id: vid, title: `Part ${idx+1}` });
        });
      }

      // parts: ["id1","id2"] (fallback name)
      if (!parts.length && Array.isArray(book?.parts) && book.parts.length) {
        book.parts.forEach((id, idx) => {
          const vid = String(id || '').trim();
          if (vid) parts.push({ id: vid, title: `Part ${idx+1}` });
        });
      }

      // single id variants
      const single = [
        book?.ytId, book?.youtubeId, book?.audioYtId, book?.audioId, book?.youtube, book?.yt
      ].filter(Boolean).map(v => String(v).trim())[0];

      if (!parts.length && single) parts.push({ id: single, title: 'Part 1' });

      return parts;
    }

    function hasAudio(book) {
      return getAudioParts(book).length > 0;
    }
    // ========================================================================

    function normalizeBooks(list) {
      return (list || []).map(b => {
        const book = { ...b };

        if (!book.categories || !Array.isArray(book.categories) || book.categories.length === 0) {
          if (book.category && typeof book.category === 'string') book.categories = [book.category];
          else book.categories = ['অন্যান্য'];
        }

        // ✅ If this book has audio, ensure "Audio Books" category exists
        if (hasAudio(book) && !book.categories.includes('Audio Books')) {
          book.categories = ['Audio Books', ...book.categories];
        }

        book.category = book.categories[0] || 'অন্যান্য';
        return book;
      });
    }

    function scrollToEl(id) {
      const el = document.getElementById(id);
      if (!el) return;

      const header = document.querySelector('header.sticky');
      const headerH = header ? header.getBoundingClientRect().height : 0;
      const extra = 10;

      const y = window.scrollY + el.getBoundingClientRect().top - headerH - extra;
      window.scrollTo({ top: Math.max(0, y), behavior: 'smooth' });
    }

    function initializeDarkMode() {
      const savedTheme = localStorage.getItem('boicloud-theme');
      if (savedTheme === null) {
        document.documentElement.classList.add('dark');
        localStorage.setItem('boicloud-theme', 'dark');
        return true;
      }
      const isDark = savedTheme === 'dark';
      document.documentElement.classList.toggle('dark', isDark);
      return isDark;
    }

    function toggleDarkMode() {
      const html = document.documentElement;
      const isDark = html.classList.contains('dark');
      html.classList.toggle('dark', !isDark);
      localStorage.setItem('boicloud-theme', !isDark ? 'dark' : 'light');
      updateDarkModeToggle(!isDark);
      return !isDark;
    }

    function updateDarkModeToggle(isDark) {
      const toggleBtn = document.getElementById('dark-mode-toggle');
      if (toggleBtn) {
        toggleBtn.innerHTML = isDark
          ? '<i data-lucide="sun" class="w-5 h-5 text-yellow-300"></i>'
          : '<i data-lucide="moon" class="w-5 h-5 text-slate-700"></i>';
        lucide.createIcons();
      }
    }

    const BOOKS_DATA = window.BOOKS_DATA || [];
    let ALL_BOOKS = normalizeBooks(BOOKS_DATA);

    // ✅ FIXED: now supports ytParts, ytIds, parts, ytId...
    const AUDIO_BOOKS = () => ALL_BOOKS.filter(b => hasAudio(b));

    const CATEGORIES = [
      'সবগুলো',
      'Audio Books',
      'উপন্যাস',
      'থ্রিলার',
      'কবিতা',
      'ইসলামিক',
      'বিজ্ঞান ও সায়েন্স ফিকশন',
      'সাহিত্য',
      'ভৌতিক',
      'জীবনী',
      'অন্যান্য'
    ];

    /* =========================================================
      ✅ Compact Audio Badge (mobile-friendly)  (FIXED)
    ========================================================= */
    function audioBadgeHTML(book) {
      // ✅ FIXED: ytParts থাকলেও icon দেখাবে
      if (!hasAudio(book)) return '';

      return `
        <div class="absolute top-2 right-1.5 z-10">
          <span class="relative inline-flex items-center justify-center w-6 h-6 rounded-full
                       bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm
                       border border-slate-100 dark:border-slate-800 shadow-sm
                       animate-blink-soft">
            <span class="absolute -top-0.5 -right-0.5 w-2 h-2 rounded-full bg-brand-500">
              <span class="absolute inset-0 rounded-full bg-brand-500 opacity-70 animate-ping"></span>
            </span>
            <i data-lucide="headphones" class="w-3.5 h-3.5 text-brand-600"></i>
          </span>
        </div>
      `;
    }

    function bookCardHTML(book, q='') {
      const catLabel = book.categories?.[0] || book.category || 'অন্যান্য';
      return `
        <a href="book.html?id=${encodeURIComponent(book.id)}"
           class="slide-item slide-w shrink-0 block group">
          <div class="slide-card rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-md hover:shadow-xl">
            <div class="aspect-[2/3] relative overflow-hidden">
              <img src="${book.coverImage}" alt="${escapeHtml(book.title)}"
                   class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy">

              <div class="absolute top-2 left-2">
                <span class="px-2.5 py-1 bg-white/90 dark:bg-slate-900/90 backdrop-blur-sm text-brand-600 text-[10px] font-black rounded-full border border-slate-100 dark:border-slate-800">
                  ${escapeHtml(catLabel)}
                </span>
              </div>

              ${audioBadgeHTML(book)}
            </div>

            <div class="p-3">
              <div class="text-[13px] font-black text-slate-900 dark:text-white line-clamp-1 group-hover:text-brand-600 transition-colors">
                ${highlight(book.title, q)}
              </div>
              <div class="text-[11px] text-slate-500 dark:text-slate-400 line-clamp-1 mt-0.5">
                ${highlight(book.author, q)}
              </div>
            </div>
          </div>
        </a>
      `;
    }

    function renderRow(containerId, books, q='') {
      const wrap = document.getElementById(containerId);
      if (!wrap) return;
      wrap.innerHTML = books.map(b => bookCardHTML(b, q)).join('');
      lucide.createIcons();
    }

    const DEFAULT_GRID_TITLE_HTML = `<i data-lucide="layout-grid" class="w-5 h-5 text-brand-600"></i> সব বই`;
    let GRID_BACK_TARGET_ID = 'row-samprotik';

    function setGridTitle(html) {
      const t = document.getElementById('grid-title');
      if (t) t.innerHTML = html;
      lucide.createIcons();
    }

    function closeGridAndBack() {
      document.getElementById('grid-area')?.classList.add('hidden');
      document.getElementById('rows-area')?.classList.remove('hidden');
      setGridTitle(DEFAULT_GRID_TITLE_HTML);
      scrollToEl(GRID_BACK_TARGET_ID || 'row-samprotik');
    }

    function openGridWith(books, titleHtml, backTargetId='row-samprotik', qForHighlight='') {
      const gridArea = document.getElementById('grid-area');
      const rowsArea = document.getElementById('rows-area');
      if (!gridArea || !rowsArea) return;

      GRID_BACK_TARGET_ID = backTargetId;

      const mainSearch = document.getElementById('search-input');
      const mobileSearch = document.getElementById('search-input-mobile');
      const clearMain = document.getElementById('search-clear');
      const clearMobile = document.getElementById('search-clear-mobile');
      if (mainSearch) mainSearch.value = '';
      if (mobileSearch) mobileSearch.value = '';
      clearMain?.classList.add('hidden');
      clearMobile?.classList.add('hidden');
      closeSuggestions();

      rowsArea.classList.add('hidden');
      gridArea.classList.remove('hidden');

      setGridTitle(titleHtml);
      renderAllBooksGrid(books, qForHighlight);
      scrollToEl('grid-area');
    }

    function showCategoryGrid(category) {
      if (category === 'Audio Books') {
        const filtered = AUDIO_BOOKS();
        openGridWith(
          filtered,
          `<i data-lucide="headphones" class="w-5 h-5 text-brand-600"></i> Audio Books`,
          `row-Audio Books`,
          ''
        );
        return;
      }

      const filtered = ALL_BOOKS.filter(b => (b.categories || []).includes(category));
      openGridWith(
        filtered,
        `<i data-lucide="layout-grid" class="w-5 h-5 text-brand-600"></i> ${escapeHtml(category)}`,
        `row-${category}`,
        ''
      );
    }

    function renderAllBooksGrid(books, q='') {
      const container = document.getElementById('books-container');
      if (!container) return;

      if (!books.length) {
        container.innerHTML = `
          <div class="col-span-full text-center py-14">
            <div class="w-16 h-16 bg-slate-100 dark:bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-4">
              <i data-lucide="search-x" class="w-8 h-8 text-slate-400"></i>
            </div>
            <h3 class="text-xl font-black dark:text-white mb-1">কোনো বই পাওয়া যায়নি</h3>
            <p class="text-slate-500 dark:text-slate-400 text-sm">অন্য কোনো নাম দিয়ে সার্চ করুন।</p>
          </div>
        `;
        lucide.createIcons();
        return;
      }

      container.innerHTML = books.map(b => `
        <a href="book.html?id=${encodeURIComponent(b.id)}"
           class="group bg-white dark:bg-slate-900 rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-800 shadow-sm hover:shadow-lg transition-all hover:-translate-y-1">
          <div class="aspect-[2/3] overflow-hidden relative">
            <img src="${b.coverImage}" alt="${escapeHtml(b.title)}"
                 class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy">
            ${audioBadgeHTML(b)}
          </div>
          <div class="p-3">
            <div class="text-sm font-black text-slate-900 dark:text-white line-clamp-1 group-hover:text-brand-600 transition-colors">${highlight(b.title, q)}</div>
            <div class="text-xs text-slate-500 dark:text-slate-400 line-clamp-1 mt-0.5">${highlight(b.author, q)}</div>
          </div>
        </a>
      `).join('');

      lucide.createIcons();
    }

    function renderSuggestions(q, filteredBooks) {
      const wrap = document.getElementById('suggestions-wrap');
      const box = document.getElementById('suggestions-box');
      if (!wrap || !box) return;

      if (!q) {
        wrap.classList.add('hidden');
        box.innerHTML = '';
        return;
      }

      const top = filteredBooks.slice(0, 6);
      const items = top.map(b => `
        <a href="book.html?id=${encodeURIComponent(b.id)}"
           class="block w-full text-left px-4 py-3 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors flex gap-3 items-center">
          <img src="${b.coverImage}" class="w-10 h-14 object-cover rounded-lg border border-slate-200 dark:border-slate-700" alt="">
          <div class="min-w-0">
            <div class="text-sm font-bold text-slate-900 dark:text-white line-clamp-1">${highlight(b.title, q)}</div>
            <div class="text-xs text-slate-500 dark:text-slate-400 line-clamp-1">
              ${highlight(b.author, q)} • <span class="text-brand-600">${escapeHtml((b.categories?.[0] || b.category || 'অন্যান্য'))}</span>
            </div>
          </div>
          <div class="ml-auto opacity-60">
            <i data-lucide="arrow-right" class="w-4 h-4"></i>
          </div>
        </a>
      `).join('');

      box.innerHTML = `
        <div class="suggestions bg-white/95 dark:bg-slate-900/95 backdrop-blur-md border border-slate-200 dark:border-slate-700 shadow-2xl">
          <div class="px-4 py-2 text-[10px] uppercase tracking-[3px] text-slate-500 dark:text-slate-400 flex items-center justify-between">
            <span>সার্চ রেজাল্ট (${filteredBooks.length})</span>
            <span class="text-brand-600 font-bold">ESC = Close</span>
          </div>
          <div class="max-h-80 overflow-auto">
            ${items || `<div class="px-4 py-6 text-sm text-slate-500 dark:text-slate-400">কোনো সাজেশন নেই</div>`}
          </div>
        </div>
      `;
      wrap.classList.remove('hidden');
      lucide.createIcons();
    }

    function closeSuggestions() {
      document.getElementById('suggestions-wrap')?.classList.add('hidden');
    }

    function applySearchAndToggleLayout(qRaw) {
      const q = (qRaw || '').trim().toLowerCase();

      const rowsArea = document.getElementById('rows-area');
      const gridArea = document.getElementById('grid-area');
      const countEl = document.getElementById('book-count');

      if (!q) {
        rowsArea?.classList.remove('hidden');
        renderSuggestions('', []);
        if (countEl) countEl.textContent = ALL_BOOKS.length;
        return;
      }

      const filtered = ALL_BOOKS.filter(book => {
        const hay = [book.title, book.author, book.description || '', (book.categories || []).join(' ')].join(' ').toLowerCase();
        return hay.includes(q);
      });

      if (countEl) countEl.textContent = filtered.length;

      GRID_BACK_TARGET_ID = 'row-samprotik';
      rowsArea?.classList.add('hidden');
      gridArea?.classList.remove('hidden');
      setGridTitle(`<i data-lucide="search" class="w-5 h-5 text-brand-600"></i> সার্চ রেজাল্ট`);
      renderAllBooksGrid(filtered, q);
      renderSuggestions(q, filtered);
      scrollToEl('grid-area');
    }

    const applySearchDebounced = debounce(applySearchAndToggleLayout, 140);

    function initializeCategoryButtons() {
      const container = document.getElementById('category-buttons');
      if (!container) return;

      container.innerHTML = CATEGORIES.map(category => `
        <button class="category-btn px-6 py-2.5 rounded-full text-sm font-bold whitespace-nowrap transition-all active:scale-95
          ${category === 'সবগুলো'
            ? 'active bg-brand-600 text-white shadow-xl shadow-brand-500/30'
            : 'bg-white dark:bg-slate-900 text-slate-500 border dark:border-slate-800 hover:border-brand-500/50'}"
          data-category="${escapeHtml(category)}">

          ${
            category === 'সবগুলো'
              ? '<i data-lucide="grid" class="w-4 h-4 inline mr-2"></i>'
              : (category === 'Audio Books'
                  ? '<i data-lucide="headphones" class="w-4 h-4 inline mr-2"></i>'
                  : ''
                )
          }

          ${escapeHtml(category)}
        </button>
      `).join('');

      const setActive = (btn) => {
        document.querySelectorAll('.category-btn').forEach(b => {
          b.classList.remove('active','bg-brand-600','text-white','shadow-xl','shadow-brand-500/30');
          b.classList.add('bg-white','dark:bg-slate-900','text-slate-500','border','dark:border-slate-800');
        });
        btn.classList.add('active','bg-brand-600','text-white','shadow-xl','shadow-brand-500/30');
        btn.classList.remove('bg-white','dark:bg-slate-900','text-slate-500','border','dark:border-slate-800');
      };

      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          setActive(btn);

          const mainSearch = document.getElementById('search-input');
          const mobileSearch = document.getElementById('search-input-mobile');
          if ((mainSearch?.value || '').trim() || (mobileSearch?.value || '').trim()) {
            if (mainSearch) mainSearch.value = '';
            if (mobileSearch) mobileSearch.value = '';
            closeSuggestions();
            document.getElementById('rows-area')?.classList.remove('hidden');
          }

          const cat = btn.dataset.category;
          if (cat === 'সবগুলো') scrollToEl('row-samprotik');
          else scrollToEl(`row-${cat}`);
        });
      });

      lucide.createIcons();
    }

    function buildRows() {
      const samprotik = [...ALL_BOOKS].reverse();
      renderRow('samprotik-slider', samprotik);

      // ✅ FIXED: Audio Books row now includes ytParts too
      renderRow('slider-Audio Books', AUDIO_BOOKS());

      CATEGORIES
        .filter(c => c !== 'সবগুলো' && c !== 'Audio Books')
        .forEach(cat => {
          const list = ALL_BOOKS.filter(b => (b.categories || []).includes(cat));
          renderRow(`slider-${cat}`, list);
        });
    }

    function bindSearchUX() {
      const mobileSearch = document.getElementById('search-input-mobile');
      const mainSearch = document.getElementById('search-input');

      const clearMain = document.getElementById('search-clear');
      const clearMobile = document.getElementById('search-clear-mobile');

      const sync = (from, to) => { if (from && to) to.value = from.value; };

      const onInput = () => {
        const q = (mainSearch?.value || '').trim();
        clearMain?.classList.toggle('hidden', !q);
        clearMobile?.classList.toggle('hidden', !q);
        applySearchDebounced(q);
      };

      mainSearch?.addEventListener('input', () => { sync(mainSearch, mobileSearch); onInput(); });
      mobileSearch?.addEventListener('input', () => { sync(mobileSearch, mainSearch); onInput(); });

      clearMain?.addEventListener('click', () => {
        if (!mainSearch) return;
        mainSearch.value = '';
        if (mobileSearch) mobileSearch.value = '';
        clearMain.classList.add('hidden');
        clearMobile?.classList.add('hidden');
        closeSuggestions();
        setGridTitle(DEFAULT_GRID_TITLE_HTML);
        applySearchAndToggleLayout('');
      });

      clearMobile?.addEventListener('click', () => {
        if (!mobileSearch) return;
        mobileSearch.value = '';
        if (mainSearch) mainSearch.value = '';
        clearMobile.classList.add('hidden');
        clearMain?.classList.add('hidden');
        closeSuggestions();
        setGridTitle(DEFAULT_GRID_TITLE_HTML);
        applySearchAndToggleLayout('');
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === '/' && !e.ctrlKey && !e.metaKey && !e.altKey) {
          const tag = (document.activeElement?.tagName || '').toLowerCase();
          if (tag === 'input' || tag === 'textarea') return;
          e.preventDefault();
          if (window.innerWidth >= 768) mainSearch?.focus();
          else mobileSearch?.focus();
        }
        if (e.key === 'Escape') closeSuggestions();
      });

      document.addEventListener('click', (e) => {
        const wrap = document.getElementById('suggestions-wrap');
        const area = document.getElementById('search-area');
        if (!wrap || wrap.classList.contains('hidden')) return;
        if (area && area.contains(e.target)) return;
        closeSuggestions();
      });
    }

    function bindFooterLinks() {
      document.getElementById('link-home')?.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
      document.getElementById('link-books')?.addEventListener('click', () => scrollToEl('row-samprotik'));
      document.getElementById('link-category')?.addEventListener('click', () => scrollToEl('category-buttons'));
      document.getElementById('link-contact')?.addEventListener('click', () => {
        window.location.href = "https://mail.google.com/mail/?view=cm&fs=1&to=html.arif@gmail.com";
      });
    }

    function initializeApp() {
      const isDarkMode = initializeDarkMode();
      updateDarkModeToggle(isDarkMode);
      document.getElementById('dark-mode-toggle')?.addEventListener('click', toggleDarkMode);

      initializeCategoryButtons();
      bindSearchUX();
      bindFooterLinks();

      buildRows();

      document.getElementById('book-count').textContent = ALL_BOOKS.length;

      document.getElementById('explore-books-btn')?.addEventListener('click', () => {
        scrollToEl('row-samprotik');
      });

      document.getElementById('show-all-grid-btn')?.addEventListener('click', () => {
        openGridWith(
          ALL_BOOKS,
          DEFAULT_GRID_TITLE_HTML,
          'row-samprotik',
          ''
        );
      });

      document.getElementById('grid-back-btn')?.addEventListener('click', closeGridAndBack);

      const y = document.getElementById('current-year');
      if (y) y.textContent = new Date().getFullYear();

      setTimeout(() => lucide.createIcons(), 50);
    }

    document.addEventListener('DOMContentLoaded', initializeApp);
  </script>

  <!-- ========================= UI (unchanged) ========================= -->
  <!-- (এখান থেকে নিচে তোমার আগের HTML একদম একই থাকবে) -->

  <header class="sticky top-0 z-50 glass-effect border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" id="search-area">
      <div class="flex justify-between items-center h-16 sm:h-20">
        <div class="flex items-center gap-3 cursor-pointer group" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
          <div class="relative flex items-center justify-center transform group-hover:rotate-6 transition-transform duration-300">
            <svg class="w-10 h-10 sm:w-12 sm:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.5 19C20.5376 19 23 16.5376 23 13.5C23 10.4624 20.5376 8 17.5 8C17.2282 8 16.9632 8.01977 16.7042 8.05791C15.6841 5.64243 13.284 4 10.5 4C6.91015 4 4 6.91015 4 10.5C4 10.742 4.0133 10.9809 4.03914 11.2158C2.26425 12.0232 1 13.8152 1 15.9C1 18.7167 3.28335 21 6.1 21H17.5V19Z" class="fill-brand-50/50 stroke-brand-500 dark:fill-brand-700/20 dark:stroke-brand-500" stroke-width="1.5"/>
              <path d="M8 13.5C8 12.9477 8.44772 12.5 9 12.5H12V16.5H9C8.44772 16.5 8 16.0523 8 15.5V13.5Z" class="fill-brand-600 dark:fill-brand-500"/>
              <path d="M16 13.5C16 12.9477 15.5523 12.5 15 12.5H12V16.5H15C15.5523 16.5 16 16.0523 16 15.5V13.5Z" class="fill-teal-400 dark:fill-teal-300"/>
            </svg>
          </div>

          <h1 class="text-xl sm:text-3xl font-black tracking-tighter whitespace-nowrap">
            <span class="text-slate-800 dark:text-white">Boi</span><span class="bg-gradient-to-r from-brand-600 to-teal-500 bg-clip-text text-transparent">Cloud</span>
          </h1>
        </div>

        <div class="hidden md:flex flex-1 max-w-md mx-6 relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
            <i data-lucide="search" class="w-5 h-5"></i>
          </div>

          <input
            type="text"
            id="search-input"
            placeholder="বই সার্চ করুন..."
            class="block w-full pl-10 pr-10 py-2 border border-slate-200 dark:border-slate-700 rounded-full bg-slate-50 dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-brand-500/50 transition-all text-sm"
            autocomplete="off"
          />

          <button id="search-clear" class="hidden absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-700 dark:hover:text-slate-200">
            <i data-lucide="x-circle" class="w-5 h-5"></i>
          </button>

          <div id="suggestions-wrap" class="hidden absolute left-0 right-0 top-full mt-2">
            <div id="suggestions-box"></div>
          </div>
        </div>

        <div class="flex items-center gap-2 sm:gap-4">
          <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400"></button>
        </div>
      </div>

      <div class="md:hidden pb-4">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
            <i data-lucide="search" class="w-4 h-4"></i>
          </div>
          <input
            type="text"
            id="search-input-mobile"
            placeholder="বই / লেখক / ক্যাটাগরি..."
            class="block w-full pl-9 pr-10 py-2 border border-slate-200 dark:border-slate-700 rounded-full bg-slate-50 dark:bg-slate-900 focus:outline-none focus:ring-2 focus:ring-brand-500/50 transition-all text-sm"
            autocomplete="off"
          />
          <button id="search-clear-mobile" class="hidden absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-700 dark:hover:text-slate-200">
            <i data-lucide="x-circle" class="w-5 h-5"></i>
          </button>
        </div>
      </div>

    </div>
  </header>

  <!-- ✅ নিচে তোমার বাকি HTML অংশ অপরিবর্তিত থাকবে -->
  <!-- (তুমি চাইলে তোমার আগের index.html থেকে main/footer 그대로 রেখে দাও) -->

  <!-- NOTE: তোমার মূল কোড অনুযায়ী main/footer ঠিকই আছে, তাই এখানে আর রিপিট করলাম না -->
</body>
</html>
