<!DOCTYPE html>
<html lang="bn" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BoiCloud | বই বিস্তারিত</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          screens: { xs: '480px' },
          fontFamily: { bengali: ['"Hind Siliguri"', 'sans-serif'] },
          colors: {
            brand: { 50:'#f0fdf4', 100:'#dcfce7', 500:'#10b981', 600:'#059669', 700:'#047857' }
          }
        }
      }
    }
  </script>

  <style>
    body { font-family: 'Hind Siliguri', sans-serif; -webkit-tap-highlight-color: transparent; }
    .glass-effect { backdrop-filter: blur(12px); background: rgba(255, 255, 255, 0.8); }
    .dark .glass-effect { background: rgba(15, 23, 42, 0.8); }
  </style>
</head>

<body class="bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-100 transition-colors duration-300 antialiased overflow-x-hidden">

  <script src="books-data.js"></script>

  <header class="sticky top-0 z-50 glass-effect border-b border-slate-200 dark:border-slate-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16 sm:h-20">
        <a href="index.html" class="flex items-center gap-3 group">
          <div class="relative flex items-center justify-center transform group-hover:rotate-6 transition-transform duration-300">
            <svg class="w-10 h-10 sm:w-12 sm:h-12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.5 19C20.5376 19 23 16.5376 23 13.5C23 10.4624 20.5376 8 17.5 8C17.2282 8 16.9632 8.01977 16.7042 8.05791C15.6841 5.64243 13.284 4 10.5 4C6.91015 4 4 6.91015 4 10.5C4 10.742 4.0133 10.9809 4.03914 11.2158C2.26425 12.0232 1 13.8152 1 15.9C1 18.7167 3.28335 21 6.1 21H17.5V19Z" class="fill-brand-50/50 stroke-brand-500 dark:fill-brand-700/20 dark:stroke-brand-500" stroke-width="1.5"/>
              <path d="M8 13.5C8 12.9477 8.44772 12.5 9 12.5H12V16.5H9C8.44772 16.5 8 16.0523 8 15.5V13.5Z" class="fill-brand-600 dark:fill-brand-500"/>
              <path d="M16 13.5C16 12.9477 15.5523 12.5 15 12.5H12V16.5H15C15.5523 16.5 16 16.0523 16 15.5V13.5Z" class="fill-teal-400 dark:fill-teal-300"/>
            </svg>
          </div>
          <h1 class="text-xl sm:text-3xl font-black tracking-tighter">
            <span class="text-slate-800 dark:text-white">Boi</span><span class="bg-gradient-to-r from-brand-600 to-teal-500 bg-clip-text text-transparent">Cloud</span>
          </h1>
        </a>

        <button id="dark-mode-toggle" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-600 dark:text-slate-400"></button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 sm:py-14">

    <!-- Breadcrumb -->
    <nav class="text-sm text-slate-500 dark:text-slate-400 mb-6">
      <div class="flex flex-wrap items-center gap-2">
        <a href="index.html" class="hover:text-brand-600 inline-flex items-center gap-1">
          <i data-lucide="home" class="w-4 h-4"></i> Home
        </a>
        <span>→</span>
        <a id="crumb-category-link" href="index.html#books-grid" class="hover:text-brand-600">Category</a>
        <span>→</span>
        <span id="crumb-title" class="text-slate-900 dark:text-white font-semibold">Book</span>
      </div>
    </nav>

    <div id="book-wrap" class="grid lg:grid-cols-12 gap-8">
      <!-- Left: cover -->
      <div class="lg:col-span-4">
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-3xl overflow-hidden shadow-lg">
          <div class="aspect-[2/3] overflow-hidden">
            <img id="book-cover" src="" alt="" class="w-full h-full object-cover" />
          </div>
        </div>
      </div>

      <!-- Right: info -->
      <div class="lg:col-span-8">
        <div class="bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-3xl p-6 sm:p-8 shadow-lg">
          <div class="flex flex-wrap items-center gap-2 mb-4">
            <span id="book-category" class="px-3 py-1 rounded-full text-[11px] font-bold bg-brand-500/10 text-brand-600 border border-brand-500/20"></span>
            <span class="px-3 py-1 rounded-full text-[11px] font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 border border-slate-200 dark:border-slate-700">
              <i data-lucide="shield-check" class="w-3 h-3 inline mr-1"></i> Premium UI
            </span>
          </div>

          <h2 id="book-title" class="text-2xl sm:text-4xl font-black tracking-tight mb-2"></h2>
          <p class="text-slate-500 dark:text-slate-400 font-medium mb-4">
            <i data-lucide="user" class="w-4 h-4 inline mr-1"></i>
            <span id="book-author"></span>
          </p>

          <p id="book-desc" class="text-slate-600 dark:text-slate-300 leading-relaxed mb-6"></p>

          <div class="flex flex-col sm:flex-row gap-3">
            <a id="read-btn" href="#" target="_blank" rel="noopener"
              class="w-full sm:w-auto px-6 py-3 rounded-2xl font-bold bg-brand-600 hover:bg-brand-700 text-white flex items-center justify-center gap-2 active:scale-95 transition-all shadow-xl shadow-brand-500/20">
              <i data-lucide="book-open" class="w-5 h-5"></i> অনলাইনে পড়ুন
            </a>

            <a id="download-btn" href="#" target="_blank" rel="noopener"
              class="w-full sm:w-auto px-6 py-3 rounded-2xl font-bold bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 border border-slate-200 dark:border-slate-700 hover:border-brand-500/40 flex items-center justify-center gap-2 active:scale-95 transition-all">
              <i data-lucide="download" class="w-5 h-5"></i> ডাউনলোড
            </a>

            <button id="share-fb"
              class="w-full sm:w-auto px-6 py-3 rounded-2xl font-bold bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center gap-2 active:scale-95 transition-all">
              <i data-lucide="share-2" class="w-5 h-5"></i> Share
            </button>

            <button id="copy-link"
              class="w-full sm:w-auto px-6 py-3 rounded-2xl font-bold bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-200 hover:bg-slate-200 dark:hover:bg-slate-700 flex items-center justify-center gap-2 active:scale-95 transition-all">
              <i data-lucide="copy" class="w-5 h-5"></i> Copy link
            </button>
          </div>
        </div>

        <!-- Related books -->
        <div class="mt-8">
          <div class="flex items-center gap-3 mb-4">
            <div class="p-2 rounded-xl bg-brand-500/10 text-brand-600">
              <i data-lucide="layers" class="w-5 h-5"></i>
            </div>
            <h3 class="text-xl font-black">Related books</h3>
            <span id="related-count" class="text-xs text-slate-500 dark:text-slate-400"></span>
          </div>

          <div id="related-grid" class="grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5"></div>
        </div>

      </div>
    </div>
  </main>

  <script>
    // Theme
    function initializeDarkMode() {
      const savedTheme = localStorage.getItem('boicloud-theme');
      if (savedTheme === null) {
        document.documentElement.classList.add('dark');
        localStorage.setItem('boicloud-theme', 'dark');
        return true;
      }
      const isDark = savedTheme === 'dark';
      document.documentElement.classList.toggle('dark', isDark);
      return isDark;
    }
    function updateDarkModeToggle(isDark) {
      const toggleBtn = document.getElementById('dark-mode-toggle');
      if (!toggleBtn) return;
      toggleBtn.innerHTML = isDark
        ? '<i data-lucide="sun" class="w-5 h-5 text-yellow-300"></i>'
        : '<i data-lucide="moon" class="w-5 h-5 text-slate-700"></i>';
      lucide.createIcons();
    }
    function toggleDarkMode() {
      const html = document.documentElement;
      const isDark = html.classList.contains('dark');
      if (isDark) {
        html.classList.remove('dark');
        localStorage.setItem('boicloud-theme', 'light');
      } else {
        html.classList.add('dark');
        localStorage.setItem('boicloud-theme', 'dark');
      }
      updateDarkModeToggle(!isDark);
    }

    // Helpers
    function getParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }
    function esc(s) { return String(s ?? '').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#039;'); }

    function makeRelatedCard(b) {
      return `
        <a href="book.html?id=${encodeURIComponent(b.id)}"
           class="group bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition-all hover:-translate-y-1">
          <div class="aspect-[2/3] overflow-hidden">
            <img src="${b.coverImage}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" alt="">
          </div>
          <div class="p-3">
            <div class="text-sm font-black text-slate-900 dark:text-white line-clamp-1 group-hover:text-brand-600 transition-colors">${esc(b.title)}</div>
            <div class="text-xs text-slate-500 dark:text-slate-400 line-clamp-1">${esc(b.author)}</div>
          </div>
        </a>
      `;
    }

    function init() {
      const isDark = initializeDarkMode();
      updateDarkModeToggle(isDark);
      document.getElementById('dark-mode-toggle')?.addEventListener('click', toggleDarkMode);

      const id = getParam('id');
      const books = (window.BOOKS_DATA || []);
      const book = books.find(b => String(b.id) === String(id));

      if (!book) {
        document.body.innerHTML = `
          <div class="min-h-screen flex items-center justify-center p-6">
            <div class="max-w-lg w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-3xl p-8 text-center shadow-lg">
              <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/10 flex items-center justify-center">
                <i data-lucide="alert-triangle" class="w-8 h-8 text-red-400"></i>
              </div>
              <h2 class="text-2xl font-black mb-2">বই খুঁজে পাওয়া যায়নি</h2>
              <p class="text-slate-500 dark:text-slate-400 mb-6">লিংক/আইডি ভুল হতে পারে।</p>
              <a href="index.html" class="inline-flex items-center justify-center gap-2 px-6 py-3 rounded-2xl bg-brand-600 hover:bg-brand-700 text-white font-bold">
                <i data-lucide="arrow-left" class="w-5 h-5"></i> হোমে ফিরে যান
              </a>
            </div>
          </div>
        `;
        lucide.createIcons();
        return;
      }

      // Page title
      document.title = `${book.title} | BoiCloud`;

      // Breadcrumb
      document.getElementById('crumb-title').textContent = book.title;

      const catLink = document.getElementById('crumb-category-link');
      catLink.textContent = book.category || (book.categories?.[0] || 'অন্যান্য');
      catLink.href = `index.html?category=${encodeURIComponent(catLink.textContent)}#books-grid`;

      // Main
      document.getElementById('book-cover').src = book.coverImage;
      document.getElementById('book-cover').alt = book.title;

      document.getElementById('book-title').textContent = book.title;
      document.getElementById('book-author').textContent = book.author || '';
      document.getElementById('book-category').textContent = catLink.textContent;
      document.getElementById('book-desc').textContent = book.description || 'এই বইটির বিস্তারিত বিবরণ শীঘ্রই যোগ করা হবে।';

      const readBtn = document.getElementById('read-btn');
      const downBtn = document.getElementById('download-btn');
      readBtn.href = book.readLink || '#';
      downBtn.href = book.downloadLink || '#';

      // Share
      const shareBtn = document.getElementById('share-fb');
      shareBtn.addEventListener('click', () => {
        const shareUrl = encodeURIComponent(window.location.href);
        window.open(`https://www.facebook.com/sharer/sharer.php?u=${shareUrl}`, '_blank', 'noopener');
      });

      // Copy
      document.getElementById('copy-link').addEventListener('click', async () => {
        try {
          await navigator.clipboard.writeText(window.location.href);
          alert('Link copied ✅');
        } catch {
          prompt('Copy this link:', window.location.href);
        }
      });

      // Related
      const cat = catLink.textContent;
      const related = books.filter(b => (b.category || b.categories?.[0]) === cat && String(b.id) !== String(book.id)).slice(0, 8);
      document.getElementById('related-count').textContent = related.length ? `(${related.length})` : '(0)';
      document.getElementById('related-grid').innerHTML = related.length
        ? related.map(makeRelatedCard).join('')
        : `<div class="col-span-full text-slate-500 dark:text-slate-400">এই ক্যাটাগরিতে আর কোনো বই পাওয়া যায়নি।</div>`;

      lucide.createIcons();
    }

    document.addEventListener('DOMContentLoaded', init);
  </script>

</body>
</html>
